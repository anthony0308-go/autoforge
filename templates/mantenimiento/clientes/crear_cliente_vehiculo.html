{% extends 'mantenimiento/base.html' %}

{% block content %}
<div class="max-w-4xl mx-auto bg-white rounded-lg shadow p-8 mt-6">
  <h2 class="text-3xl font-bold mb-6 text-[#D7141A]">Registrar Cliente y Veh√≠culo</h2>

  {% if messages %}
    <ul class="mb-4">
      {% for message in messages %}
        <li class="p-3 rounded text-white
                   {% if message.tags == 'error' %}bg-red-600
                   {% elif message.tags == 'success' %}bg-green-600
                   {% else %}bg-gray-600{% endif %}">
          {{ message }}
        </li>
      {% endfor %}
    </ul>
  {% endif %}

  <form method="post" enctype="multipart/form-data" class="space-y-6">
    {% csrf_token %}
    
    <!-- DATOS DEL CLIENTE -->
    <fieldset class="border border-gray-300 p-4 rounded">
      <legend class="text-lg font-semibold text-gray-700 px-2">Informaci√≥n del Cliente</legend>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
        <div>
          <label class="block text-sm font-medium">Nombre</label>
          {{ cliente_form.first_name }}
        </div>
        <div>
          <label class="block text-sm font-medium">Apellido</label>
          {{ cliente_form.last_name }}
        </div>
        <div>
          <label class="block text-sm font-medium">Correo electr√≥nico</label>
          {{ cliente_form.email }}
        </div>
        <div>
          <label class="block text-sm font-medium">Tel√©fono</label>
          {{ cliente_form.telefono }}
        </div>
        <div>
          <label class="block text-sm font-medium">DUI</label>
          {{ cliente_form.dui }}
        </div>
        <div class="md:col-span-2">
          <label class="block text-sm font-medium">Direcci√≥n</label>
          {{ cliente_form.direccion }}
        </div>
      </div>
    </fieldset>

    <!-- DATOS DEL VEH√çCULO -->
    <fieldset class="border border-gray-300 p-4 rounded">
      <legend class="text-lg font-semibold text-gray-700 px-2">Informaci√≥n del Veh√≠culo</legend>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
        <div>
          <label class="block text-sm font-medium">Placa</label>
          {{ vehiculo_form.placa }}
        </div>
        <div>
          <label class="block text-sm font-medium">Marca</label>
          {{ vehiculo_form.marca }}
        </div>
        <div>
          <label class="block text-sm font-medium">Modelo</label>
          {{ vehiculo_form.modelo }}
        </div>
        <div>
          <label class="block text-sm font-medium">A√±o</label>
          {{ vehiculo_form.anio }}
        </div>
        <div>
          <label class="block text-sm font-medium">Color</label>
          {{ vehiculo_form.color }}
        </div>
        <div>
          <label class="block text-sm font-medium">Tipo de combustible</label>
          {{ vehiculo_form.tipo_combustible }}
        </div>
        <div class="md:col-span-2">
          <label class="block text-sm font-medium">VIN</label>
          {{ vehiculo_form.vin }}
        </div>
      </div>
    </fieldset>

    <!-- FOTOS DEL VEH√çCULO -->
    <fieldset class="border border-gray-300 p-4 rounded">
      <legend class="text-lg font-semibold text-gray-700 px-2">Fotograf√≠as del Veh√≠culo</legend>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
        <div>
          <label class="block text-sm font-medium">Foto frontal</label>
          {{ vehiculo_form.foto_frontal }}
        </div>
        <div>
          <label class="block text-sm font-medium">Foto lateral izquierda</label>
          {{ vehiculo_form.foto_lateral_izquierda }}
        </div>
        <div>
          <label class="block text-sm font-medium">Foto lateral derecha</label>
          {{ vehiculo_form.foto_lateral_derecha }}
        </div>
        <div>
          <label class="block text-sm font-medium">Foto trasera</label>
          {{ vehiculo_form.foto_trasera }}
        </div>
      </div>
    </fieldset>

    <!-- BOT√ìN SUBMIT -->
    <div class="text-right">
      <button type="submit" class="px-6 py-2 bg-[#1565C0] text-white rounded hover:bg-[#0D47A1] transition">
        üíæ Guardar cliente y veh√≠culo
      </button>
    </div>
  </form>
</div>

{% block scripts %}
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const telefonoInput = document.querySelector('#id_telefono');
            const duiInput = document.querySelector('#id_dui');

            // Mascara para el tel√©fono: ####-####
            telefonoInput.addEventListener('input', function (e) {
                let value = e.target.value.replace(/\D/g, '');  // Eliminar todo lo no num√©rico
                if (value.length > 4) {
                    value = value.substring(0, 4) + '-' + value.substring(4, 8);  // Insertar guion
                }
                e.target.value = value;
            });

            // Mascara para el DUI: #######-#
            duiInput.addEventListener('input', function (e) {
                let value = e.target.value.replace(/\D/g, '');  // Eliminar todo lo no num√©rico
                if (value.length > 8) {
                    value = value.substring(0, 8) + '-' + value.substring(8, 9);  // Insertar guion
                }
                e.target.value = value;
            });
        });
    </script>
{% endblock %}
{% endblock %}
